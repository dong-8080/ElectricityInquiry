# ElectricityInquiry

简单的查询电费，试着能不能保存数据并做一些可视化工作。

重写了获取电量的接口，访问一段时间后总是会数据访问异常，尝试的解决方案如下：

刚开始认为是公众号上有反爬虫机制，因此使用了两个简单的应对策略：禁用cookie和使用多组user-agent访问，发现效果不好，认为主要矛盾不在反爬虫机制上，也不考虑使用ip池；

后来逐渐发现，数据获取异常后也不能从公众号上手动访问，多次测试后推测原因可能是频繁访问后，公众号服务器获取电量数据压力太大，因此拒绝访问或者是崩溃，自然无法访问，过段时间会自动重启。解决策略为降低访问频次，尝试如下：
* 每隔一秒发送一次请求，以此降低访问频次，还是会造成数据访问异常；
* 每隔一秒发送一次请求，同时每次访问有一定的概率多等待一段时间，采用了10%的概率等待10s，在数据访问异常前获取的数据多了一些，但还是会出现数据获取异常；
* 以更大的访问间歇获取数据，这样获取的数据量会比较有限，多多尝试在获取的数据量与等待时间中找到一个合适的平衡点，甚至可以试试TCP/IP中的拥塞避免之类的策略；
* 希望想法是对的，to be continue...

随便玩玩，不一定能成，只做自己宿舍的也好。

